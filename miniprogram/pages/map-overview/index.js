// pages/map-overview/index.js - å®Œæ•´æ•°æ®ç‰ˆï¼ˆå…±53ä¸ªåœ°æ ‡ï¼‰
Page({
  data: {
    // åœ°å›¾ä¸­å¿ƒç‚¹ï¼šé¾™äº­å…¬å›­
    longitude: 114.35113,
    latitude: 34.805,
    // ç¼©æ”¾çº§åˆ«ï¼š15ï¼ˆé€‚ä¸­ï¼Œé¿å…æ ‡è®°ç‚¹æ‹¥æŒ¤ï¼‰
    scale: 15,
    markers: [],
    dotPaths:{},
    showLabels: true,
    
    // åº•éƒ¨å¼¹çª—ç›¸å…³æ•°æ®
    showBottomPopup: false,
    popupData: {
      name: '',
      ancientName: '',
      dynasty: '',
      type: '',
      intro: '',
      // åªéœ€è¦markerIcon
      markerIcon: ''
  }
  },
  
  onLoad() {
    console.log('å…¨å±å¼€å°åœ°å›¾åŠ è½½å®Œæˆ');
    this.initMapMarkers();
    this.drawColorDots();
  },
  drawColorDots() {
    const colors = [
      { id: 'red', color: '#d2704d', canvasId: 'redDot' },
      { id: 'blue', color: '#5d95a9', canvasId: 'blueDot' },
      { id: 'green', color: '#709a89', canvasId: 'greenDot' },
      { id: 'brown', color: '#3b0d0d', canvasId: 'brownDot' }
    ];

    colors.forEach(item => {
      const ctx = wx.createCanvasContext(item.canvasId);
      const size = 80; // ç”»å¸ƒå¤§å°
      const radius = 30; // åœ†å½¢åŠå¾„
      
      // 1. ç”»åœ†å½¢
      ctx.beginPath();
      ctx.arc(size/2, size/2, radius, 0, 2 * Math.PI);
      ctx.setFillStyle(item.color);
      ctx.fill();
      
      // 2. ç”»ç™½è‰²è¾¹æ¡†ï¼ˆå¯é€‰ï¼‰
      ctx.setLineWidth(2);
      ctx.setStrokeStyle('#FFFFFF');
      ctx.stroke();
      
      // 3. ç»˜åˆ¶
      ctx.draw(false, () => {
        // ä¿å­˜ä¸ºä¸´æ—¶å›¾ç‰‡
        wx.canvasToTempFilePath({
          canvasId: item.canvasId,
          success: (res) => {
            const dotPaths = this.data.dotPaths;
            dotPaths[item.id] = res.tempFilePath;
            this.setData({ dotPaths });
            
            console.log(`ç”Ÿæˆ${item.id}è‰²åœ†å½¢:`, res.tempFilePath);
            
            // å¦‚æœæ‰€æœ‰åœ†å½¢éƒ½ç”Ÿæˆå¥½äº†ï¼ŒåŠ è½½åœ°å›¾æ•°æ®
            if (Object.keys(dotPaths).length === 4) {
              this.loadMapData();
            }
          },
          fail: (err) => {
            console.error('ç”Ÿæˆåœ†å½¢å¤±è´¥:', err);
            // å¦‚æœç”Ÿæˆå¤±è´¥ï¼Œç”¨ä¸€ä¸ªé»˜è®¤å›¾ç‰‡
            const dotPaths = this.data.dotPaths;
            dotPaths[item.id] = '/images/default-dot.png';
            this.setData({ dotPaths });
          }
        });
      });
    });
  },

  // åŠ è½½åœ°å›¾æ•°æ®ï¼ˆç­‰åœ†å½¢ç”Ÿæˆåå†è°ƒç”¨ï¼‰
  loadMapData() {
    // ä½ çš„åœ°å›¾æ•°æ®åŠ è½½ä»£ç 
    console.log('åœ†å½¢å·²ç”Ÿæˆï¼Œå¼€å§‹åŠ è½½åœ°å›¾æ•°æ®');
    
    // è¿™é‡Œè°ƒç”¨ä½ åŸæ¥çš„åŠ è½½æ•°æ®æ–¹æ³•
    this.loadLandmarkData();
  },

  initMapMarkers() {
    // ç¡¬ç¼–ç æ‰€æœ‰åœ°æ ‡çš„GeoJSONæ•°æ®ï¼ˆ53ä¸ªåœ°æ ‡ï¼‰
    const landmarkData = {
      "type": "FeatureCollection",
      "features": [
        // åŸæœ‰29ä¸ªé—å€ï¼ˆID 1-29ï¼‰
        {"type":"Feature","id":1,"properties":{"name":"ç¹å¡”","type":"å®—æ•™å»ºç­‘","intro":"åŒ—å®‹æ—¶æœŸè‘—åæ¥¼é˜å¼ç –å¡”ï¼Œå¼€å°ç°å­˜æœ€å¤è€çš„åœ°é¢å»ºç­‘ä¹‹ä¸€ã€‚"},"geometry":{"type":"Point","coordinates":[114.364807,34.769842]}},
        {"type":"Feature","id":2,"properties":{"name":"é¡ºå¤©é—¨","type":"åŸé—¨é—å€","intro":"åŒ—å®‹ä¸œäº¬åŸå¤–åŸè¥¿å¢™åŒ—é—¨"},"geometry":{"type":"Point","coordinates":[114.30506137,34.79514005]}},
        {"type":"Feature","id":3,"properties":{"name":"ä¸‡èƒœé—¨é—å€","type":"åŸé—¨é—å€","intro":"åŒ—å®‹ä¸œäº¬åŸå¤–åŸè¥¿å¢™å—é—¨"},"geometry":{"type":"Point","coordinates":[114.298,34.805]}},
        {"type":"Feature","id":4,"properties":{"name":"æ™¯é¾™é—¨é—å€","type":"åŸé—¨é—å€","intro":"åŒ—å®‹ä¸œäº¬åŸå†…åŸåŒ—å¢™è¥¿é—¨"},"geometry":{"type":"Point","coordinates":[114.3582,34.8165]}},
        {"type":"Feature","id":5,"properties":{"name":"é“å¡”","type":"å®—æ•™å»ºç­‘","intro":"åŒ—å®‹å¼€å®å¯ºå¡”ï¼Œç‰ç’ƒç –å¡”"},"geometry":{"type":"Point","coordinates":[114.3665947,34.81297911]}},
        {"type":"Feature","id":6,"properties":{"name":"å·æ¡¥é—å€","type":"é—å€","intro":"æ¨ªè·¨æ±´æ²³çš„é‡è¦æ¡¥æ¢"},"geometry":{"type":"Point","coordinates":[114.350844,34.790644]}},
        {"type":"Feature","id":7,"properties":{"name":"æ±´æ²³é—å€","type":"æ°´ç³»é—å€","intro":"åŒ—å®‹ä¸œäº¬åŸç”Ÿå‘½çº¿è¿æ²³"},"geometry":{"type":"Point","coordinates":[114.34581348,34.79137629]}},
        {"type":"Feature","id":8,"properties":{"name":"æ±´æ²³æ•…é“ï¼ˆå±€éƒ¨æ®µï¼‰","type":"æ°´ç³»é—å€","intro":"æ±´æ²³å±€éƒ¨æ²³é“é—è¿¹"},"geometry":{"type":"Point","coordinates":[114.34581348,34.79137629]}},
        {"type":"Feature","id":9,"properties":{"name":"å¤–åŸæŠ¤åŸå£•è¥¿å¢™å—æ®µ","type":"é˜²å¾¡é—å€","intro":"å¤–åŸè¥¿å¢™å—æ®µæŠ¤åŸæ²³"},"geometry":{"type":"Point","coordinates":[114.2915,34.7868]}},
        {"type":"Feature","id":10,"properties":{"name":"å¤–åŸå—å¢™æŠ¤åŸå£•ï¼ˆå—è–°é—¨æ®µï¼‰","type":"é˜²å¾¡é—å€","intro":"å¤–åŸå—å¢™æŠ¤åŸæ²³å—è–°é—¨æ®µ"},"geometry":{"type":"Point","coordinates":[114.3058,34.7892]}},
        {"type":"Feature","id":11,"properties":{"name":"å†…åŸæŠ¤åŸå£•åŒ—å¢™æ®µ","type":"é˜²å¾¡é—å€","intro":"å†…åŸåŒ—å¢™æ®µæŠ¤åŸæ²³"},"geometry":{"type":"Point","coordinates":[114.3076,34.7981]}},
        {"type":"Feature","id":12,"properties":{"name":"å·æ¡¥é—å€æŠ¤åŸå…³è”åŒº","type":"é˜²å¾¡é—å€","intro":"å·æ¡¥é™„è¿‘çš„æŠ¤åŸæ²³åŒºåŸŸ"},"geometry":{"type":"Point","coordinates":[114.3082,34.7925]}},
        {"type":"Feature","id":13,"properties":{"name":"æ˜ä»£å‘¨ç‹åºœå…¸ä»ªæ‰€æ ¸å¿ƒåŒº","type":"å»ºç­‘é—å€","intro":"æ˜ä»£å‘¨ç‹åºœå…¸ä»ªæ‰€æ‰€åœ¨åŒºåŸŸ"},"geometry":{"type":"Point","coordinates":[114.3526,34.7938]}},
        {"type":"Feature","id":14,"properties":{"name":"é¡ºå¤©é—¨é—å€åšç‰©é¦†","type":"æ–‡åšåœºé¦†","intro":"é¡ºå¤©é—¨é—å€åšç‰©é¦†"},"geometry":{"type":"Point","coordinates":[114.30506137,34.79514005]}},
        {"type":"Feature","id":15,"properties":{"name":"å¤§åº†æ®¿","type":"å®«æ®¿é—å€","intro":"åŒ—å®‹çš‡å®«ä¸»æ®¿"},"geometry":{"type":"Point","coordinates":[114.35216703,34.80504713]}},
        {"type":"Feature","id":16,"properties":{"name":"å¼€å°åºœ","type":"è¡™ç½²é—å€","intro":"åŒ—å®‹é¦–éƒ½åºœè¡™"},"geometry":{"type":"Point","coordinates":[114.34648023,34.78970693]}},
        {"type":"Feature","id":17,"properties":{"name":"æœ±é›€é—¨","type":"åŸé—¨é—å€","intro":"åŒ—å®‹ä¸œäº¬åŸå†…åŸæ­£å—é—¨"},"geometry":{"type":"Point","coordinates":[114.34999825,34.78570687]}},
        {"type":"Feature","id":18,"properties":{"name":"å—è–°é—¨","type":"åŸé—¨é—å€","intro":"åŒ—å®‹ä¸œäº¬åŸå¤–åŸæ­£å—é—¨"},"geometry":{"type":"Point","coordinates":[114.34975415,34.7824267]}},
        {"type":"Feature","id":19,"properties":{"name":"æ–°é—¨","type":"åŸé—¨é—å€","intro":"åŒ—å®‹ä¸œäº¬åŸå¤–åŸè¥¿å¢™åŸé—¨"},"geometry":{"type":"Point","coordinates":[114.35874464,34.78177436]}},
        {"type":"Feature","id":20,"properties":{"name":"å¤§æ¢é—¨","type":"åŸé—¨é—å€","intro":"å¼€å°å¤åŸè¥¿é—¨ï¼Œå§‹äºå”"},"geometry":{"type":"Point","coordinates":[114.32911439,34.8020847]}},
        {"type":"Feature","id":21,"properties":{"name":"æ›¹é—¨","type":"åŸé—¨é—å€","intro":"å¼€å°å¤åŸä¸œé—¨ï¼Œå®‹ä»£ç§°æ—§æ›¹é—¨"},"geometry":{"type":"Point","coordinates":[114.36564974,34.8005551]}},
        {"type":"Feature","id":22,"properties":{"name":"å®‹é—¨","type":"åŸé—¨é—å€","intro":"å¼€å°å¤åŸä¸œé—¨ï¼Œå®‹ä»£ç§°æ—§å®‹é—¨"},"geometry":{"type":"Point","coordinates":[114.36155453,34.78762725]}},
        {"type":"Feature","id":23,"properties":{"name":"é‡‘æ˜æ± ","type":"å›­æ—é—å€","intro":"åŒ—å®‹çš‡å®¶æ°´ä¸Šå›­æ—ä¸æ¼”ç»ƒåœº"},"geometry":{"type":"Point","coordinates":[114.30093852,34.79970635]}},
        {"type":"Feature","id":24,"properties":{"name":"å¤§ç›¸å›½å¯º","type":"å®—æ•™å»ºç­‘","intro":"åŒ—å®‹çš‡å®¶å¯ºé™¢ï¼Œä¸œäº¬æœ€å¤§ä½›å¯º"},"geometry":{"type":"Point","coordinates":[114.35460544,34.7919434]}},
        {"type":"Feature","id":25,"properties":{"name":"å¼€å®å¯º","type":"å®—æ•™å»ºç­‘","intro":"åŒ—å®‹è‘—åçš‡å®¶å¯ºé™¢ï¼Œå†…æœ‰é“å¡”"},"geometry":{"type":"Point","coordinates":[114.37253228,34.81220727]}},
        {"type":"Feature","id":26,"properties":{"name":"å¤©æ´¥æ¡¥","type":"æ¡¥æ¢é—å€","intro":"æ±´æ²³ä¸Šè‘—åæ¡¥æ¢"},"geometry":{"type":"Point","coordinates":[114.3517204,34.79054879]}},
        {"type":"Feature","id":27,"properties":{"name":"æ¨Šæ¥¼","type":"å•†ä¸šé—å€","intro":"åŒ—å®‹ä¸œäº¬æœ€è‘—åçš„é«˜çº§é…’æ¥¼"},"geometry":{"type":"Point","coordinates":[114.35125766,34.80216961]}},
        {"type":"Feature","id":28,"properties":{"name":"æ¸…æ˜ä¸Šæ²³å›­","type":"ç°ä»£æ™¯åŒº","intro":"ä»¥ã€Šæ¸…æ˜ä¸Šæ²³å›¾ã€‹ä¸ºè“æœ¬çš„å®‹ä»£æ–‡åŒ–ä¸»é¢˜å…¬å›­"},"geometry":{"type":"Point","coordinates":[114.340685,34.809044]}},
        {"type":"Feature","id":29,"properties":{"name":"å¼€å°åºœï¼ˆç°ä»£æ™¯åŒºï¼‰","type":"ç°ä»£æ™¯åŒº","intro":"ä»¿å»ºçš„åŒ—å®‹å¼€å°åºœè¡™"},"geometry":{"type":"Point","coordinates":[114.3465,34.789726]}},
        
        // æ–°å¢ç°ä»£æ™¯ç‚¹ï¼ˆID 30-43ï¼‰
        {"type":"Feature","id":30,"properties":{"name":"å¤§å®‹æ­¦ä¾ åŸ","type":"ç°ä»£æ™¯åŒº","intro":"å®‹ä»£æ­¦ä¾ æ–‡åŒ–ä¸»é¢˜æ™¯åŒº"},"geometry":{"type":"Point","coordinates":[114.3518,34.819966]}},
        {"type":"Feature","id":31,"properties":{"name":"ä¸­å›½ç¿°å›­","type":"ç°ä»£æ™¯åŒº","intro":"ä¸­å›½é¦–å®¶æ°‘åŠä¹¦æ³•å›­æ—"},"geometry":{"type":"Point","coordinates":[114.344712,34.80992]}},
        {"type":"Feature","id":32,"properties":{"name":"å¼€å°åšç‰©é¦†","type":"æ–‡åšåœºé¦†","intro":"å¼€å°å¸‚ç»¼åˆæ€§åšç‰©é¦†"},"geometry":{"type":"Point","coordinates":[114.253818,34.803533]}},
        {"type":"Feature","id":33,"properties":{"name":"å¼€å°ç¾æœ¯åšç‰©é¦†","type":"æ–‡åšåœºé¦†","intro":"å¼€å°å¸‚ä¸“ä¸šç¾æœ¯åšç‰©é¦†"},"geometry":{"type":"Point","coordinates":[114.255025,34.803475]}},
        {"type":"Feature","id":34,"properties":{"name":"å·æ¡¥é—å€åšç‰©é¦†","type":"æ–‡åšåœºé¦†","intro":"å·æ¡¥é—å€ä¸“é¢˜åšç‰©é¦†"},"geometry":{"type":"Point","coordinates":[114.351484,34.790533]}},
        {"type":"Feature","id":35,"properties":{"name":"ä¹¦åº—è¡—","type":"å•†ä¸šè¡—åŒº","intro":"å¼€å°å†å²æ–‡åŒ–å•†ä¸šè¡—"},"geometry":{"type":"Point","coordinates":[114.356206,34.799431]}},
        {"type":"Feature","id":36,"properties":{"name":"é©¬é“è¡—","type":"å•†ä¸šè¡—åŒº","intro":"å¼€å°ä¼ ç»Ÿå•†ä¸šè¡—"},"geometry":{"type":"Point","coordinates":[114.355622,34.793751]}},
        {"type":"Feature","id":37,"properties":{"name":"é¼“æ¥¼è¡—","type":"å•†ä¸šè¡—åŒº","intro":"å¼€å°ä¸­å¿ƒå•†ä¸šè¡—"},"geometry":{"type":"Point","coordinates":[114.357801,34.793724]}},
        {"type":"Feature","id":38,"properties":{"name":"é¾™äº­å…¬å›­","type":"ç°ä»£æ™¯åŒº","intro":"æ¸…ä»£å»ºç­‘ï¼Œå»ºäºå®‹å®«åŸºå€ä¸Š"},"geometry":{"type":"Point","coordinates":[114.35113,34.811187]}},
        {"type":"Feature","id":39,"properties":{"name":"å¤©æ³¢æ¨åºœ","type":"ç°ä»£æ™¯åŒº","intro":"åŒ—å®‹æŠ—è¾½è‹±é›„æ¨ä¸šåºœé‚¸é‡å»º"},"geometry":{"type":"Point","coordinates":[114.347433,34.810734]}},
        {"type":"Feature","id":40,"properties":{"name":"åŒ…å…¬ç¥ ","type":"ç°ä»£æ™¯åŒº","intro":"çºªå¿µåŒ—å®‹åè‡£åŒ…æ‹¯çš„ç¥ å ‚"},"geometry":{"type":"Point","coordinates":[114.33911,34.792935]}},
        {"type":"Feature","id":41,"properties":{"name":"å¤§å®‹å¾¡æ²³ï¼ˆæ¸¸èˆ¹ï¼‰","type":"ç°ä»£æ™¯åŒº","intro":"å¼€å°æ°´ç³»å·¥ç¨‹ï¼Œå¯ä¹˜èˆ¹æ¸¸è§ˆ"},"geometry":{"type":"Point","coordinates":[114.344842,34.807615]}},
        {"type":"Feature","id":42,"properties":{"name":"é¼“æ¥¼å¤œå¸‚","type":"å•†ä¸šè¡—åŒº","intro":"å¼€å°è‘—åå¤œå¸‚å°åƒè¡—"},"geometry":{"type":"Point","coordinates":[114.355996,34.793914]}},
        {"type":"Feature","id":43,"properties":{"name":"å°å®‹åŸ","type":"ç°ä»£æ™¯åŒº","intro":"å¼€å°å®¤å†…æ–‡åŒ–æ—…æ¸¸ç»¼åˆä½“"},"geometry":{"type":"Point","coordinates":[114.310757,34.803281]}},
        
        // âœ… æ–°å¢å†å²é—å€ï¼ˆID 44-53ï¼‰
        {"type":"Feature","id":44,"properties":{"name":"å®£å¾·é—¨","type":"åŸé—¨é—å€","intro":"å¼€å°å®£å¾·é—¨æ˜¯åŒ—å®‹ä¸œäº¬åŸçš„æ­£å—é—¨ï¼Œåˆç§°å®£å¾·æ¥¼ï¼Œå§‹å»ºäºäº”ä»£åå‘¨ï¼ŒåŒ—å®‹æ—¶æœŸæˆä¸ºå®«åŸæ ¸å¿ƒé—¨æˆ·ã€‚"},"geometry":{"type":"Point","coordinates":[114.351514,34.803083]}},
        {"type":"Feature","id":45,"properties":{"name":"å¾¡å²å°","type":"è¡™ç½²é—å€","intro":"å¾¡å²å°æ˜¯å®‹ä»£ä¸­å¤®æœ€é«˜ç›‘å¯Ÿä¸å¸æ³•æœºæ„ï¼Œå·ç§°'å®ªå°'ã€‚å…¶æ ¸å¿ƒèŒèƒ½æ˜¯ç›‘å¯Ÿç™¾å®˜ã€å¼¹åŠ¾ä¸æ³•ã€è‚ƒæ­£çº²çºªï¼Œå¹¶è´Ÿè´£å®¡ç†ä¸­å¤®å®˜å‘˜çš„é‡å¤§æ¡ˆä»¶ï¼ˆè¯ç‹±ï¼‰ã€‚"},"geometry":{"type":"Point","coordinates":[114.338049,34.793285]}},
        {"type":"Feature","id":46,"properties":{"name":"ä¿åº·é—¨","type":"åŸé—¨é—å€","intro":"ä¿åº·é—¨æ˜¯åŒ—å®‹ä¸œäº¬åŸé‡ŒåŸï¼ˆå†…åŸï¼‰ä¸œé¢çš„é‡è¦åŸé—¨ï¼Œä½äºæ±´æ²³åŒ—å²¸ï¼Œç´§é‚»è‘—åçš„å•†ä¸šå¨±ä¹åŒº'æ—§å®‹é—¨'ä¸€å¸¦ã€‚"},"geometry":{"type":"Point","coordinates":[114.331467,34.785792]}},
        {"type":"Feature","id":47,"properties":{"name":"ç¼æ—è‹‘","type":"å›­æ—é—å€","intro":"ç¼æ—è‹‘æ˜¯åŒ—å®‹ä¸œäº¬åŸè‘—åçš„çš‡å®¶å›­æ—ï¼Œä½äºå¤–åŸè¥¿å¢™é¡ºå¤©é—¨å¤–ï¼Œä¸é‡‘æ˜æ± å—åŒ—ç›¸å¯¹ã€‚"},"geometry":{"type":"Point","coordinates":[114.303684,34.795788]}},
        {"type":"Feature","id":48,"properties":{"name":"å¤ªå¹³å…´å›½å¯º","type":"å®—æ•™å»ºç­‘","intro":"å¤ªå¹³å…´å›½å¯ºæ˜¯åŒ—å®‹ä¸œäº¬åŸçš„é‡è¦çš‡å®¶åŠŸå¾·å¯ºé™¢ï¼Œç”±å®‹å¤ªå®—ä»¥å…¶å¹´å·'å¤ªå¹³å…´å›½'æ••å»ºã€‚"},"geometry":{"type":"Point","coordinates":[114.332456,34.800740]}},
        {"type":"Feature","id":49,"properties":{"name":"é†´æ³‰è§‚","type":"å®—æ•™å»ºç­‘","intro":"é†´æ³‰è§‚æ˜¯åŒ—å®‹ä¸œäº¬è‘—åçš„çš‡å®¶é“è§‚ï¼Œä¸»è¦åŠŸèƒ½ä¸ºä¾›å¥‰ä¸œå²³æ³°å±±ç¥ï¼ˆå¤©é½ä»åœ£å¸ï¼‰ï¼Œæ˜¯æœå»·ä¸¾è¡Œå›½å®¶ç¥­ç¥€ä¸é“æ•™é†®ä»ªçš„é‡è¦åœºæ‰€ã€‚"},"geometry":{"type":"Point","coordinates":[114.322948,34.806838]}},
        {"type":"Feature","id":50,"properties":{"name":"ç›¸å›½å¯ºæ¡¥","type":"æ¡¥æ¢é—å€","intro":"ç›¸å›½å¯ºæ¡¥æ˜¯æ±´æ²³ä¸Šé‡è¦æ¡¥æ¢ï¼Œè¿æ¥å¤§ç›¸å›½å¯ºä¸å‘¨è¾¹ç¹åå•†ä¸šåŒºï¼Œä¸ºå®‹ä»£ä¸œäº¬åŸäº¤é€šè¦é“ã€‚"},"geometry":{"type":"Point","coordinates":[114.353320,34.788120]}},
        {"type":"Feature","id":51,"properties":{"name":"æ¡‘å®¶ç“¦å­","type":"å•†ä¸šé—å€","intro":"æ¡‘å®¶ç“¦å­æ˜¯åŒ—å®‹ä¸œäº¬åŸè§„æ¨¡æœ€å¤§ã€æœ€è´Ÿç››åçš„ç»¼åˆæ€§å¨±ä¹ä¸­å¿ƒï¼Œå³'ç“¦èˆ'ï¼Œä½äºæ½˜æ¥¼è¡—å—ï¼ŒåŒ…å«ä¸­ç“¦ã€é‡Œç“¦ç­‰ã€‚"},"geometry":{"type":"Point","coordinates":[114.354887,34.793358]}},
        {"type":"Feature","id":52,"properties":{"name":"é©¬è¡Œè¡—","type":"å•†ä¸šè¡—åŒº","intro":"é©¬è¡Œè¡—æ˜¯åŒ—å®‹ä¸œäº¬åŸå—åŒ—å‘åŒ»è¯äº§ä¸šæ ¸å¿ƒåŒºä¸ç¹åå•†ä¸šè¡—ï¼ŒåŒ—èµ·æ—§å°ä¸˜é—¨ï¼Œå—æ¥æ½˜æ¥¼è¡—åŒºã€‚"},"geometry":{"type":"Point","coordinates":[114.364113,34.814558]}},
        
      ]
    };

    if (!landmarkData || !landmarkData.features) {
      console.error('æ•°æ®æ ¼å¼é”™è¯¯');
      return;
    }
    
    console.log('âœ… æ•°æ®åŠ è½½æˆåŠŸï¼Œå…±', landmarkData.features.length, 'ä¸ªåœ°æ ‡');
    
    // åˆ›å»ºæ ‡è®°ï¼Œåˆå§‹æ˜¾ç¤ºæ ‡ç­¾
    const markers = this.createMarkersWithCallout(landmarkData.features, this.data.showLabels);
    
    this.setData({ markers });
    console.log('âœ… åœ°å›¾æ ‡è®°ç‚¹è®¾ç½®å®Œæˆï¼Œå…±', markers.length, 'ä¸ªç‚¹');
  },

  // åˆ›å»ºå¸¦calloutçš„æ ‡è®°
  createMarkersWithCallout(features, showLabels) {
    return features.map(item => {
      const props = item.properties;
      
      // æ ¹æ®ç±»å‹é€‰æ‹©ä¸åŒé¢œè‰²
      const style = this.getMarkerStyle(props.type);
      
      return {
        id: item.id,
        longitude: item.geometry.coordinates[0],
        latitude: item.geometry.coordinates[1],
        title: props.name,
        iconPath: style.iconPath || '/images/marker.png',
        width: 30,
        height: 30,
        customData: props,
        
        // å…³é”®ï¼šæ·»åŠ callouté…ç½®
        callout: {
          content: props.name,
          color: style.textColor,
          bgColor: style.bgColor,
          padding: 4,
          borderRadius: 4,
          borderWidth: 1,
          borderColor: style.borderColor,
          display: showLabels ? 'ALWAYS' : 'BYCLICK',
          fontSize: 12,
          textAlign: 'center'
        }
      };
    });
  },

  getMarkerStyle(type) {
    // å®šä¹‰5ç§å›¾æ ‡çš„æ ·å¼
    const styles = {
      // 1. åŸé—¨/å®«é˜™ç±»
      'åŸé—¨/å®«é˜™ç±»': {
        bgColor: '#d2704d',      // éœçº¢è‰²
        textColor: '#FFFFFF',
        borderColor: '#b85c3b',
        iconPath: '/images/marker-gate.png',  // åŸé—¨å›¾æ ‡
        width: 40,
        height: 40
      },
      
      // 2. å®—æ•™å»ºç­‘ç±»
      'å®—æ•™å»ºç­‘ç±»': {
        bgColor: '#5d95a9',      // å¤©é’è‰²
        textColor: '#FFFFFF',
        borderColor: '#4a7a8c',
        iconPath: '/images/marker-temple.png',  // å®—æ•™å›¾æ ‡
        width: 40,
        height: 40
      },
      
      // 3. é—å€/è€ƒå¤ç‚¹ç±»
      'é—å€/è€ƒå¤ç‚¹ç±»': {
        bgColor: '#709a89',      // æ±´ç»¿è‰²
        textColor: '#FFFFFF',
        borderColor: '#5c806f',
        iconPath: '/images/marker-site.png',  // é—å€å›¾æ ‡
        width: 40,
        height: 40
      },
      
      // 4. æ–‡åšåœºé¦†ç±»
      'æ–‡åšåœºé¦†ç±»': {
        bgColor: '#3b0d0d',      // æ·±è¤è‰²
        textColor: '#FFFFFF',
        borderColor: '#2a0909',
        iconPath: '/images/marker-museum.png',  // æ–‡åšå›¾æ ‡
        width: 40,
        height: 40
      },
      
      // 5. é»˜è®¤æ ·å¼ï¼ˆå…¶ä»–ç±»å‹ï¼‰
      'default': {
        bgColor: '#8dbbd2',      // åœ°å›¾ä¸»è‰²
        textColor: '#FFFFFF',
        borderColor: '#7a9bb0',
        iconPath: '/images/marker-default.png',  // é»˜è®¤å›¾æ ‡
        width: 36,
        height: 36
      }
    };
  
  // ========== ç±»å‹åŒ¹é…é€»è¾‘ ==========
  // å¦‚æœæ²¡ç±»å‹ï¼Œè¿”å›é»˜è®¤
  if (!type) {
    console.log('æœªæä¾›ç±»å‹ï¼Œä½¿ç”¨é»˜è®¤å›¾æ ‡');
    return styles.default;
  }
  
  // 1. ç›´æ¥åŒ¹é…
  if (styles[type]) {
    console.log('ç›´æ¥åŒ¹é…ç±»å‹:', type);
    return styles[type];
  }
  
  // 2. åŒ…å«åŒ¹é…
  const typeLower = type.toLowerCase();
  
  // åŸé—¨/å®«é˜™ç±»åŒ¹é…
  if (typeLower.includes('åŸé—¨') || 
      typeLower.includes('å®«é˜™') || 
      typeLower.includes('å®«åŸ') ||
      typeLower.includes('é—¨é—å€') ||
      typeLower.includes('é¡ºå¤©é—¨') ||
      typeLower.includes('æ–°éƒ‘é—¨') ||
      typeLower.includes('æœ±é›€é—¨') ||
      typeLower.includes('å—è–°é—¨') ||
      typeLower.includes('æ¢é—¨') ||
      typeLower.includes('æ›¹é—¨') ||
      typeLower.includes('å®‹é—¨') ||
      typeLower.includes('æ™¯é¾™é—¨')) {
    console.log('åŒ¹é…ä¸ºåŸé—¨ç±»:', type);
    return styles['åŸé—¨/å®«é˜™ç±»'];
  }
  
  // å®—æ•™å»ºç­‘ç±»åŒ¹é…
  else if (typeLower.includes('å®—æ•™') || 
           typeLower.includes('å»ºç­‘') || 
           typeLower.includes('å¯º') ||
           typeLower.includes('å¡”') ||
           typeLower.includes('åº™') ||
           typeLower.includes('è§‚') ||
           typeLower.includes('é“å¡”') ||
           typeLower.includes('ç¹å¡”') ||
           typeLower.includes('å¼€å®å¯º') ||
           typeLower.includes('å¤§ç›¸å›½å¯º') ||
           typeLower.includes('å¤ªå¹³å…´å›½å¯º')) {
    console.log('åŒ¹é…ä¸ºå®—æ•™ç±»:', type);
    return styles['å®—æ•™å»ºç­‘ç±»'];
  }
  
  // é—å€/è€ƒå¤ç‚¹ç±»åŒ¹é…
  else if (typeLower.includes('é—å€') || 
           typeLower.includes('è€ƒå¤') || 
           typeLower.includes('å‘æ˜') ||
           typeLower.includes('é—è¿¹') ||
           typeLower.includes('æ•…é“') ||
           typeLower.includes('å¤¯åœŸ') ||
           typeLower.includes('å·æ¡¥') ||
           typeLower.includes('æ±´æ²³') ||
           typeLower.includes('æŠ¤åŸæ²³') ||
           typeLower.includes('å‘¨ç‹åºœ')) {
    console.log('åŒ¹é…ä¸ºé—å€ç±»:', type);
    return styles['é—å€/è€ƒå¤ç‚¹ç±»'];
  }
  
  // æ–‡åšåœºé¦†ç±»åŒ¹é…
  else if (typeLower.includes('æ–‡åš') || 
           typeLower.includes('åœºé¦†') || 
           typeLower.includes('åšç‰©é¦†') ||
           typeLower.includes('å±•è§ˆ') ||
           typeLower.includes('é™ˆåˆ—') ||
           typeLower.includes('å¼€å°åšç‰©é¦†') ||
           typeLower.includes('å·æ¡¥é—å€åšç‰©é¦†') ||
           typeLower.includes('é¡ºå¤©é—¨é—å€åšç‰©é¦†')) {
    console.log('åŒ¹é…ä¸ºæ–‡åšç±»:', type);
    return styles['æ–‡åšåœºé¦†ç±»'];
  }
  
  // 3. éƒ½ä¸åŒ¹é…ï¼Œè¿”å›é»˜è®¤
  console.log('æœªåŒ¹é…åˆ°ç±»å‹ï¼Œä½¿ç”¨é»˜è®¤å›¾æ ‡:', type);
  return styles.default;
},
  // æ ‡è®°ç‚¹å‡»äº‹ä»¶ - æ˜¾ç¤ºåº•éƒ¨å¼¹çª—
  onMarkerTap(e) {
    const markerId = e.detail.markerId;
    const marker = this.data.markers.find(m => m.id === markerId);
    
    if (marker && marker.customData) {
      console.log('ğŸ“ ç‚¹å‡»æ ‡è®°:', marker.customData.name);
      
      // æ˜¾ç¤ºåº•éƒ¨å¼¹çª—
      this.showBottomPopup(marker.customData);
    }
  },

  // æ˜¾ç¤ºåº•éƒ¨å¼¹çª—
showBottomPopup(landmarkData) {
  // è·å–è¯¦ç»†æ•°æ®
  const details = this.getLandmarkFullDetails(landmarkData.name);
  
  // ä½¿ç”¨getMarkerStyleè·å–æ­£ç¡®çš„å›¾æ ‡æ ·å¼
  const styleInfo = this.getMarkerStyle(landmarkData.type);
  console.log('è·å–çš„å›¾æ ‡è·¯å¾„:', styleInfo.iconPath);
  
  this.setData({
      showBottomPopup: true,
      popupData: {
          name: landmarkData.name,
          ancientName: details.ancientName,
          dynasty: details.dynasty,
          type: landmarkData.type,
          intro: details.intro || landmarkData.intro,
          // æ·»åŠ markerIconï¼Œä½¿ç”¨ä¸åœ°å›¾markerç›¸åŒçš„å›¾æ ‡
          markerIcon: styleInfo.iconPath || this.getTypeIcon(landmarkData.type)
      }
  });
},
  // è·å–é—å€å®Œæ•´ä¿¡æ¯
getLandmarkFullDetails(name) {
  const detailsMap = {
    // å·²æœ‰æ•°æ® (1-10)
    'é“å¡”': {
      ancientName: 'å¼€å®å¯ºå¡” / çµæ„Ÿå¡”',
      dynasty: 'åŒ—å®‹ (1049å¹´é‡å»º)',
      intro: 'å¼€å°é“å¡”ä¸ºåŒ—å®‹çš‡ç¥å…ƒå¹´(1049å¹´)é‡å»ºçš„å…«è§’åä¸‰å±‚æ¥¼é˜å¼ç‰ç’ƒç –å¡”ï¼Œé«˜55.88ç±³ï¼Œä»¥é“è‰²ç‰ç’ƒç –ç Œç­‘ï¼Œå†ç»åƒå¹´é£é›¨æˆ˜ç«å·ç„¶å±¹ç«‹ï¼Œç´ æœ‰â€œå¤©ä¸‹ç¬¬ä¸€å¡”â€ä¹‹ç§°ã€‚'
    },
    'ç¹å¡”': {
      ancientName: 'å¤©æ¸…å¯ºå¡” / å…´æ…ˆå¡”',
      dynasty: 'åŒ—å®‹ (å§‹å»ºäº974å¹´)',
      intro: 'ç¹å¡”å§‹å»ºäºåŒ—å®‹å¼€å®ä¸ƒå¹´ï¼ŒåŸä¸ºå…«è§’åä¸‰å±‚æ¥¼é˜å¼ç –å¡”ï¼Œæ˜¯å¼€å°ç°å­˜æœ€å¤è€çš„åœ°é¢å»ºç­‘ï¼Œå¡”èº«ç –é›•ç²¾ç¾ï¼Œç°ä¸ºå…¨å›½é‡ç‚¹æ–‡ç‰©ä¿æŠ¤å•ä½ã€‚'
    },
    'é¡ºå¤©é—¨': {
      ancientName: 'æ–°éƒ‘é—¨ / é¡ºå¤©é—¨',
      dynasty: 'åŒ—å®‹ (å¤–åŸè¥¿é¢æ­£é—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬åŸå¤–åŸè¥¿é¢æ­£é—¨ï¼Œå¾¡é“é—¨æˆ·ï¼Œé—¨å¤–ä¸´é‡‘æ˜æ± ä¸ç¼æ—è‹‘ï¼Œé—å€ä¿å­˜å®Œå¥½ï¼Œç°è®¾æœ‰é¡ºå¤©é—¨é—å€åšç‰©é¦†ã€‚'
    },
    'ä¸‡èƒœé—¨é—å€': {
      ancientName: 'ä¸‡èƒœé—¨',
      dynasty: 'åŒ—å®‹ (å¤–åŸè¥¿å¢™åŸé—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬å¤–åŸè¥¿å¢™ä¸­éƒ¨åŸé—¨ï¼Œå› é€šä¸‡èƒœé•‡å¾—åï¼Œä¸ºè¥¿å‘äº¤é€šè¦é“ï¼Œ2003å¹´è€ƒå¤æ¢æ˜å…¶å¹³é¢å‘ˆé•¿æ–¹å½¢ã€‚'
    },
    'æ™¯é¾™é—¨é—å€': {
      ancientName: 'æ™¯é¾™é—¨',
      dynasty: 'åŒ—å®‹ (å†…åŸåŒ—é—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬å†…åŸåŒ—é—¨æ ¸å¿ƒï¼Œä¸€é—¨ä¸‰é“å¸ƒå±€ï¼Œé€šé˜”çº¦60ç±³ï¼Œä¸ºåŒ—å®‹æ™šæœŸå®˜å¼å»ºç­‘å…¸èŒƒï¼Œæ˜¯â€œåŸæ‘åŸâ€å¥‡è§‚çš„é‡è¦å®è¯ã€‚'
    },
    'å·æ¡¥é—å€': {
      ancientName: 'å¤©æ±‰æ¡¥',
      dynasty: 'åŒ—å®‹ (æ¨ªè·¨æ±´æ²³)',
      intro: 'åŒ—å®‹ä¸œäº¬åŸå¾¡è¡—ä¸æ±´æ²³äº¤æ±‡å¤„çš„æ ‡å¿—æ€§æ¡¥æ¢ï¼Œæ­£å¯¹å¤§å†…å®£å¾·é—¨ï¼Œ2022å¹´å…¥é€‰â€œå…¨å›½åå¤§è€ƒå¤æ–°å‘ç°â€ã€‚'
    },
    'æ±´æ²³é—å€': {
      ancientName: 'æ±´æ²³ / é€šæµæ¸ ',
      dynasty: 'éš‹å”è‡³åŒ—å®‹',
      intro: 'éš‹å”å¤§è¿æ²³é€šæµæ¸ å¼€å°æ®µï¼Œä¸ºåŒ—å®‹ä¸œäº¬åŸæ¼•è¿å‘½è„‰ï¼Œå¹´æ¼•è¿é‡æœ€é«˜è¾¾700ä¸‡çŸ³ï¼Œæ”¯æ’‘ç™¾ä¸‡äººå£ç”Ÿè®¡ã€‚'
    },
    'æ±´æ²³æ•…é“ï¼ˆå±€éƒ¨æ®µï¼‰': {
      ancientName: 'æ±´æ²³æ²³é“',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹ä¸œäº¬åŸâ€œç”Ÿå‘½çº¿â€æ±´æ²³çš„å±€éƒ¨æ²³é“é—è¿¹ï¼Œä¸¤å²¸æ›¾å•†é“ºå¯†é›†ï¼Œå‚¬ç”Ÿâ€œå·æ¡¥å¤œå¸‚â€ç­‰ç¹ååœºæ™¯ã€‚'
    },
    'å¤–åŸæŠ¤åŸå£•è¥¿å¢™å—æ®µ': {
      ancientName: 'æŠ¤é¾™æ²³ (å¤–åŸæ®µ)',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹ä¸œäº¬å¤–åŸé˜²å¾¡ä½“ç³»æ ¸å¿ƒï¼ŒæŠ¤åŸå£•å®½çº¦38ç±³ï¼Œé‡‡ç”¨æ¢…èŠ±å¤¯ç­‘æ³•ï¼Œå…¼å…·é˜²å¾¡ã€é˜²æ´ªä¸æ¼•è¿è¾…åŠ©åŠŸèƒ½ã€‚'
    },
    'å¤–åŸå—å¢™æŠ¤åŸå£•ï¼ˆå—è–°é—¨æ®µï¼‰': {
      ancientName: 'æŠ¤é¾™æ²³ (å—è–°é—¨æ®µ)',
      dynasty: 'åŒ—å®‹',
      intro: 'å¤–åŸæ­£é—¨å—è–°é—¨é…å¥—çš„é˜²å¾¡è®¾æ–½ï¼Œç“®åŸä¸åŸå£•å½¢æˆåŒé‡å±éšœï¼Œç°éƒ¨åˆ†å·²çº³å…¥é—å€å±•ç¤ºèŒƒå›´ã€‚'
    },

    // å·²æœ‰æ•°æ® (11-20)
    'å†…åŸæŠ¤åŸå£•åŒ—å¢™æ®µ': {
      ancientName: 'æŠ¤åŸæ²³ (å†…åŸåŒ—æ®µ)',
      dynasty: 'åŒ—å®‹',
      intro: 'å†…åŸåŒ—å¢™æ®µæŠ¤åŸæ²³ï¼Œè¿é€šé‡‘æ°´æ²³ç­‰æ°´ç³»ï¼Œæ‰¿æ‹…çš‡åŸå‘¨è¾¹é˜²æ´ªåŠŸèƒ½ï¼Œä¸åŒ—å®‹çš‡å®«é—å€æ ¸å¿ƒåŒºé‡å ã€‚'
    },
    'å·æ¡¥é—å€æŠ¤åŸå…³è”åŒº': {
      ancientName: 'æ±´æ²³ä¸æŠ¤åŸå£•è¿é€šå¤„',
      dynasty: 'åŒ—å®‹',
      intro: 'å·æ¡¥é™„è¿‘æ±´æ²³ä¸æŠ¤åŸå£•è¿é€šçš„æ¼•è¿é˜²å¾¡èŠ‚ç‚¹ï¼Œé—è¿¹å·²éšå·æ¡¥è€ƒå¤å‘æ˜æ­ç¤ºã€‚'
    },
    'æ˜ä»£å‘¨ç‹åºœå…¸ä»ªæ‰€æ ¸å¿ƒåŒº': {
      ancientName: 'å‘¨ç‹åºœå…¸ä»ªæ‰€',
      dynasty: 'æ˜ä»£ (å å‹å®‹å®«)',
      intro: 'æ˜ä»£å‘¨ç‹åºœé‡è¦å®˜ç½²é—å­˜ï¼Œå…¶ä¸‹å å‹é‡‘ä»£çš‡å®«åŒ—å¢™åŠåŒ—å®‹å†…åŸåŒ—å¢™ï¼Œæ˜¯â€œåŸæ‘åŸâ€ç°è±¡çš„å…¸å‹ä»£è¡¨ã€‚'
    },
    'é¡ºå¤©é—¨é—å€åšç‰©é¦†': {
      ancientName: 'é¡ºå¤©é—¨ (æ–°éƒ‘é—¨) é—å€',
      dynasty: 'ç°ä»£ (å±•ç¤ºåŒ—å®‹é—å€)',
      intro: 'å¼€å°é¦–åº§è€ƒå¤é—å€ç±»åšç‰©é¦†ï¼Œå®Œæ•´å±•ç¤ºåŒ—å®‹â€œä¸€é—¨ä¸‰é“â€éƒ½åŸæ­£é—¨å»ºåˆ¶ä¸â€œåŸæ‘åŸâ€åœ°å±‚å¥‡è§‚ã€‚'
    },
    'å¤§åº†æ®¿': {
      ancientName: 'å¤§åº†æ®¿',
      dynasty: 'åŒ—å®‹ (çš‡å®«ä¸»æ®¿)',
      intro: 'åŒ—å®‹çš‡å®«ä¸»æ®¿ï¼Œä¸ºçš‡å¸ä¸¾è¡Œå¤§æœä¼šç­‰é‡è¦å…¸ç¤¼çš„åœºæ‰€ï¼Œæ˜¯åŒ—å®‹ä¸œäº¬åŸå®«åŸæ ¸å¿ƒå»ºç­‘ã€‚'
    },
    'å¼€å°åºœ': {
      ancientName: 'å¼€å°åºœè¡™',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹é¦–éƒ½åºœè¡™ï¼Œå†å²ä¸ŠåŒ…æ‹¯æ›¾åœ¨æ­¤ä»»èŒï¼Œä»¥æ‰§æ³•å¦‚å±±ã€åˆšæ­£ä¸é˜¿é—»åäºä¸–ã€‚'
    },
    'æœ±é›€é—¨': {
      ancientName: 'æœ±é›€é—¨',
      dynasty: 'åŒ—å®‹ (å†…åŸæ­£å—é—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬å†…åŸæ­£å—é—¨ï¼Œä½äºå¾¡è¡—å—ç«¯ï¼Œæ˜¯å†…åŸé€šå¾€ç¹åå—è–°é—¨åŒºåŸŸçš„é‡è¦é—¨æˆ·ã€‚'
    },
    'å—è–°é—¨': {
      ancientName: 'å—è–°é—¨',
      dynasty: 'åŒ—å®‹ (å¤–åŸæ­£å—é—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬å¤–åŸæ­£å—é—¨ï¼Œä¸ºéƒ½åŸå—é¢ä¸»è¦å‡ºå£ï¼Œé—¨å¤–æœ‰å¾¡è·¯ï¼Œå»ºç­‘è§„æ ¼è¾ƒé«˜ã€‚'
    },
    'æ–°é—¨': {
      ancientName: 'æ–°é—¨',
      dynasty: 'åŒ—å®‹ (å¤–åŸè¥¿å¢™åŸé—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬å¤–åŸè¥¿å¢™åŸé—¨ä¹‹ä¸€ï¼Œå…·ä½“åŠŸèƒ½ä¸å†å²æ²¿é©å¾…è¿›ä¸€æ­¥è€ƒå¤ç ”ç©¶ç¡®è®¤ã€‚'
    },
    'å¤§æ¢é—¨': {
      ancientName: 'å¤§æ¢é—¨ / è¥¿é—¨',
      dynasty: 'å”å§‹å»ºï¼Œå†ä»£é‡ä¿®',
      intro: 'å¼€å°å¤åŸè¥¿é—¨ï¼Œå…¶åå¯è¿½æº¯è‡³æˆ˜å›½é­éƒ½å¤§æ¢ï¼Œç°å­˜åŸé—¨ä¸º1998å¹´é‡å»ºï¼Œæ˜¯å¤éƒ½çš„é‡è¦è±¡å¾ã€‚'
    },

    // å·²æœ‰æ•°æ® (21-30)
    'æ›¹é—¨': {
      ancientName: 'æ›¹é—¨ / ä»å’Œé—¨',
      dynasty: 'åŒ—å®‹å§‹å»ºï¼Œç°å­˜ä¸ºæ¸…ä»£',
      intro: 'å¼€å°å¤åŸä¸œé—¨ï¼Œå®‹ä»£ç§°æ—§æ›¹é—¨ï¼Œå‡ºæ­¤é—¨å¯é€šæ›¹å·ï¼ˆä»Šå±±ä¸œèæ³½ï¼‰ï¼Œç°å­˜ä¸ºæ¸…é“å…‰å¹´åé‡ä¿®ã€‚'
    },
    'å®‹é—¨': {
      ancientName: 'å®‹é—¨ / ä¸½æ™¯é—¨',
      dynasty: 'åŒ—å®‹å§‹å»ºï¼Œç°å­˜ä¸ºæ¸…ä»£',
      intro: 'å¼€å°å¤åŸä¸œé—¨ï¼Œå®‹ä»£ç§°æ—§å®‹é—¨ï¼Œå‡ºæ­¤é—¨å¯é€šå®‹å·ï¼ˆä»Šæ²³å—å•†ä¸˜ï¼‰ï¼Œç°å­˜ä¸ºæ¸…é“å…‰å¹´åé‡ä¿®ã€‚'
    },
    'é‡‘æ˜æ± ': {
      ancientName: 'é‡‘æ˜æ± ',
      dynasty: 'åŒ—å®‹ (çš‡å®¶å›­æ—)',
      intro: 'åŒ—å®‹è‘—åçš‡å®¶æ°´ä¸Šå›­æ—ä¸æ¼”ç»ƒåœºï¼Œä½äºé¡ºå¤©é—¨å¤–ï¼Œæ¯å¹´ä¸‰æœˆå¯¹å£«åº¶å¼€æ”¾ï¼Œä¾›çºµæƒ…æ¸¸è§ˆã€‚'
    },
    'å¤§ç›¸å›½å¯º': {
      ancientName: 'å¤§ç›¸å›½å¯º / å»ºå›½å¯º',
      dynasty: 'åŒ—é½å§‹å»ºï¼ŒåŒ—å®‹é¼ç››',
      intro: 'åŒ—å®‹çš‡å®¶å¯ºé™¢ï¼Œä¸œäº¬æœ€å¤§ä½›å¯ºï¼Œæ¯æœˆå¼€æ”¾äº”æ¬¡æˆä¸ºä¸‡å§“äº¤æ˜“çš„å¤§å¸‚åœºï¼Œå¯ºå†…å…«è§’ç‰ç’ƒæ®¿ä¾›å¥‰åƒæ‰‹åƒçœ¼è§‚éŸ³ã€‚'
    },
    'å¼€å®å¯º': {
      ancientName: 'å¼€å®å¯º',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹è‘—åçš‡å®¶å¯ºé™¢ï¼Œå†…åŸå»ºæœ‰ä¾›å¥‰ä½›èˆåˆ©çš„æœ¨å¡”ï¼ˆç¦èƒœå¡”ï¼‰ï¼Œååœ¨å…¶ä¸Šæ–¹é™¢é‡å»ºç‰ç’ƒç –å¡”ï¼ˆä»Šé“å¡”ï¼‰ã€‚'
    },
    'å¤©æ´¥æ¡¥': {
      ancientName: 'å¤©æ´¥æ¡¥',
      dynasty: 'åŒ—å®‹ (æ±´æ²³ä¸Šæ¡¥æ¢)',
      intro: 'æ±´æ²³ä¸Šè‘—åæ¡¥æ¢ä¹‹ä¸€ï¼Œå…·ä½“ä½ç½®ä¸å†å²æ²¿é©å¾…è¿›ä¸€æ­¥è€ƒå¤ä¸æ–‡çŒ®ç ”ç©¶ç¡®è®¤ã€‚'
    },
    'æ¨Šæ¥¼': {
      ancientName: 'æ¨Šæ¥¼',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹ä¸œäº¬æœ€è‘—åçš„é«˜çº§é…’æ¥¼ï¼Œåˆç§°ç™½çŸ¾æ¥¼ï¼Œå»ºç­‘å®ä¼Ÿï¼Œä¸ºäº¬åŸé…’è‚†ä¹‹ç”²ï¼Œæ˜¯å½“æ—¶è¾¾å®˜è´µäººé¥®å®´ä¹‹æ‰€ã€‚'
    },
    'æ¸…æ˜ä¸Šæ²³å›­': {
      ancientName: 'å‚ç…§ã€Šæ¸…æ˜ä¸Šæ²³å›¾ã€‹æ–°å»º',
      dynasty: 'ç°ä»£ä»¿å®‹ä¸»é¢˜å…¬å›­',
      intro: 'ä»¥å¼ æ‹©ç«¯ã€Šæ¸…æ˜ä¸Šæ²³å›¾ã€‹ä¸ºè“æœ¬å»ºé€ çš„å¤§å‹å®‹ä»£æ–‡åŒ–ä¸»é¢˜å…¬å›­ï¼Œç”ŸåŠ¨å†ç°åŒ—å®‹ä¸œäº¬çš„å¸‚äº•é£æƒ…ä¸ç¹åæ™¯è±¡ã€‚'
    },
    'å¼€å°åºœï¼ˆç°ä»£æ™¯åŒºï¼‰': {
      ancientName: 'ä»¿å»ºåŒ—å®‹å¼€å°åºœè¡™',
      dynasty: 'ç°ä»£ä»¿å®‹æ™¯åŒº',
      intro: 'ä¸ºçºªå¿µåŒ…æ‹¯ä¸åŒ—å®‹å¼€å°åºœå†å²è€Œå»ºçš„ä»¿å¤æ™¯åŒºï¼Œé€šè¿‡å»ºç­‘ä¸æ¼”å‡ºå±•ç°å®‹ä»£åºœè¡™æ–‡åŒ–ä¸åŒ…å…¬æ•…äº‹ã€‚'
    },
    'å¤§å®‹æ­¦ä¾ åŸ': {
      ancientName: 'ç°ä»£ä¸»é¢˜æ™¯åŒº',
      dynasty: 'ç°ä»£',
      intro: 'ä»¥å®‹ä»£æ­¦ä¾ æ–‡åŒ–ä¸ºä¸»é¢˜çš„å¤§å‹æ—…æ¸¸æ™¯åŒºï¼Œé€šè¿‡å®æ™¯æ¼”å‡ºã€äº’åŠ¨ä½“éªŒå±•ç°å®‹ä»£æ±Ÿæ¹–ä¸ä¾ ä¹‰ç²¾ç¥ã€‚'
    },

    // å·²æœ‰æ•°æ® (31-40)
    'ä¸­å›½ç¿°å›­': {
      ancientName: 'ç°ä»£ä¹¦æ³•å›­æ—',
      dynasty: 'ç°ä»£',
      intro: 'ä¸­å›½é¦–å®¶æ°‘åŠä¹¦æ³•å›­æ—ï¼Œé›†å†ä»£ä¹¦æ³•ç¢‘åˆ»è‰ºæœ¯ä¹‹å¤§æˆï¼Œæ˜¯å±•ç¤ºä¸­åä¹¦æ³•æ–‡åŒ–çš„é‡è¦åœºæ‰€ã€‚'
    },
    'å¼€å°åšç‰©é¦†': {
      ancientName: 'ç°ä»£æ–‡åšåœºé¦†',
      dynasty: 'ç°ä»£',
      intro: 'å¼€å°å¸‚ç»¼åˆæ€§åšç‰©é¦†ï¼Œå…¨é¢æ”¶è—ã€ç ”ç©¶ã€å±•ç¤ºå¼€å°åœ°åŒºä»å²å‰è‡³è¿‘ä»£çš„çè´µæ–‡ç‰©ä¸å†å²ã€‚'
    },
    'å¼€å°ç¾æœ¯åšç‰©é¦†': {
      ancientName: 'ç°ä»£æ–‡åšåœºé¦†',
      dynasty: 'ç°ä»£',
      intro: 'å¼€å°å¸‚ä¸“ä¸šç¾æœ¯åšç‰©é¦†ï¼Œè‡´åŠ›äºæ”¶è—ã€å±•ç¤ºä¸ç ”ç©¶å¤ä»Šä¸­å¤–ä¼˜ç§€ç¾æœ¯ä½œå“ï¼Œæ¨åŠ¨è‰ºæœ¯äº¤æµã€‚'
    },
    'å·æ¡¥é—å€åšç‰©é¦†': {
      ancientName: 'å·æ¡¥ï¼ˆå¤©æ±‰æ¡¥ï¼‰é—å€',
      dynasty: 'ç°ä»£ (é—å€ä¸“é¢˜é¦†)',
      intro: 'å±•ç¤ºå·æ¡¥åŠæ±´æ²³é—å€è€ƒå¤æˆæœçš„ä¸“é¢˜åšç‰©é¦†ï¼Œä¸ºå…¬ä¼—è§£è¯»â€œåŸæ‘åŸâ€å¥‡è§‚ä¸å¤§è¿æ²³ä¸œäº¬åŸæ®µå†å²ã€‚'
    },
    'ä¹¦åº—è¡—': {
      ancientName: 'ä¹¦åº—è¡—',
      dynasty: 'æ¸…è‡³ç°ä»£',
      intro: 'å¼€å°å†å²æ–‡åŒ–å•†ä¸šè¡—ï¼Œä»¥é›†ä¸­ä¼—å¤šä¹¦åº—ã€æ–‡å…·åº—åŠä¼ ç»Ÿæ–‡åŒ–å•†é“ºä¸ºç‰¹è‰²ï¼Œå»¶ç»­å¤åŸæ–‡è„‰ã€‚'
    },
    'é©¬é“è¡—': {
      ancientName: 'é©¬é“è¡—',
      dynasty: 'æ¸…è‡³ç°ä»£',
      intro: 'å¼€å°ä¼ ç»Ÿå•†ä¸šè¡—ï¼Œå†å²ä¸Šå¯èƒ½ä¸å†›äº‹æˆ–äº¤é€šåŠŸèƒ½ç›¸å…³ï¼Œç°ä¸ºç¹åçš„å•†ä¸šè¡—åŒºä¹‹ä¸€ã€‚'
    },
    'é¼“æ¥¼è¡—': {
      ancientName: 'é¼“æ¥¼è¡—',
      dynasty: 'æ¸…è‡³ç°ä»£',
      intro: 'å¼€å°ä¸­å¿ƒå•†ä¸šè¡—ï¼Œå› ä½äºé¼“æ¥¼å¹¿åœºå‘¨è¾¹å¾—åï¼Œæ˜¯å¤åŸç°ä»£å•†ä¸šä¸å†å²é£è²Œäº¤æ±‡çš„æ ¸å¿ƒåŒºåŸŸã€‚'
    },
    'é¾™äº­å…¬å›­': {
      ancientName: 'åŒ—å®‹çš‡å®«é—å€',
      dynasty: 'æ¸…ä»£å»ºäºå®‹å®«åŸºå€',
      intro: 'å…¬å›­åè½äºåŒ—å®‹çš‡å®«é—å€ä¹‹ä¸Šï¼Œä¸»ä½“å»ºç­‘é¾™äº­ä¸ºæ¸…ä»£æ‰€å»ºï¼Œæ˜¯ä¿¯ç°å¼€å°å¤åŸé£è²Œçš„æ ‡å¿—æ€§æ™¯ç‚¹ã€‚'
    },
    'å¤©æ³¢æ¨åºœ': {
      ancientName: 'å¤©æ³¢æ¨åºœ (é‡å»º)',
      dynasty: 'ç°ä»£ä»¿å®‹ (çºªå¿µåŒ—å®‹æ¨å®¶å°†)',
      intro: 'ä¸ºçºªå¿µåŒ—å®‹æŠ—è¾½è‹±é›„æ¨å®¶å°†è€Œé‡å»ºçš„åºœé‚¸æ™¯åŒºï¼Œå±•ç°æ¨å®¶å°†å¿ çƒˆæ–‡åŒ–ä¸å®‹ä»£åºœé‚¸å»ºç­‘é£æ ¼ã€‚'
    },
    'åŒ…å…¬ç¥ ': {
      ancientName: 'åŒ…å…¬ç¥  (é‡å»º)',
      dynasty: 'ç°ä»£ (çºªå¿µåŒ—å®‹åŒ…æ‹¯)',
      intro: 'ä¸ºçºªå¿µåŒ—å®‹åè‡£åŒ…æ‹¯è€Œé‡å»ºçš„ç¥ å ‚ï¼Œå±•ç°å…¶æ¸…æ­£å»‰æ˜ã€æ‰§æ³•å¦‚å±±çš„å½¢è±¡ï¼Œæ˜¯é‡è¦çš„å»‰æ”¿æ–‡åŒ–æ•™è‚²åŸºåœ°ã€‚'
    },

    // å·²æœ‰æ•°æ® (41-53)
    'å¤§å®‹å¾¡æ²³ï¼ˆæ¸¸èˆ¹ï¼‰': {
      ancientName: 'ç°ä»£æ°´ç³»å·¥ç¨‹',
      dynasty: 'ç°ä»£',
      intro: 'å¼€å°æ°´ç³»è¿é€šå·¥ç¨‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ¸¸å®¢å¯ä¹˜èˆ¹æ¸¸è§ˆï¼Œæ„Ÿå—åŒ—æ–¹æ°´åŸé£è²Œä¸æ²¿å²¸å†å²æ–‡åŒ–æ™¯è§‚ã€‚'
    },
    'é¼“æ¥¼å¤œå¸‚': {
      ancientName: 'é¼“æ¥¼å¤œå¸‚',
      dynasty: 'ç°ä»£ (ä¼ æ‰¿å®‹ä»£å¤œå¸‚æ–‡åŒ–)',
      intro: 'å¼€å°è‘—åå¤œå¸‚å°åƒè¡—ï¼Œæ±‡èšç³ç…æ»¡ç›®çš„ç‰¹è‰²ç¾é£Ÿï¼Œç”ŸåŠ¨å»¶ç»­äº†åŒ—å®‹ä¸œäº¬â€œå¤œå¸‚ç›´è‡³ä¸‰æ›´å°½â€çš„ç¹åä¼ ç»Ÿã€‚'
    },
    'å°å®‹åŸ': {
      ancientName: 'ç°ä»£æ–‡æ—…ç»¼åˆä½“',
      dynasty: 'ç°ä»£',
      intro: 'å¼€å°å®¤å†…æ–‡åŒ–æ—…æ¸¸ç»¼åˆä½“ï¼Œé›†ç¾é£Ÿã€æ¼”è‰ºã€æ–‡åˆ›ã€ä½“éªŒäºä¸€ä½“ï¼Œè¥é€ æ²‰æµ¸å¼å®‹æ–‡åŒ–ä¼‘é—²ç©ºé—´ã€‚'
    },
    'å®£å¾·é—¨': {
      ancientName: 'å®£å¾·æ¥¼',
      dynasty: 'åŒ—å®‹ (å®«åŸæ­£å—é—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬å®«åŸæ­£å—é—¨ï¼Œåˆç§°å®£å¾·æ¥¼ï¼Œå»ºç­‘å®ä¼Ÿï¼Œä¸ºçš‡å¸ä¸¾è¡Œé‡å¤§å…¸ç¤¼ä¸é¢å¸ƒè¯ä»¤çš„åœºæ‰€ã€‚'
    },
    'å¾¡å²å°': {
      ancientName: 'å®ªå°',
      dynasty: 'åŒ—å®‹',
      intro: 'å®‹ä»£ä¸­å¤®æœ€é«˜ç›‘å¯Ÿä¸å¸æ³•æœºæ„ï¼Œå·ç§°â€œå®ªå°â€ï¼Œè´Ÿè´£ç›‘å¯Ÿç™¾å®˜ã€å¼¹åŠ¾ä¸æ³•ã€å®¡ç†é‡å¤§æ¡ˆä»¶ï¼ˆè¯ç‹±ï¼‰ã€‚'
    },
    'ä¿åº·é—¨': {
      ancientName: 'ä¿åº·é—¨',
      dynasty: 'åŒ—å®‹ (å†…åŸä¸œé¢åŸé—¨)',
      intro: 'åŒ—å®‹ä¸œäº¬å†…åŸä¸œé¢çš„é‡è¦åŸé—¨ï¼Œä½äºæ±´æ²³åŒ—å²¸ï¼Œç´§é‚»æ—§å®‹é—¨å•†ä¸šå¨±ä¹åŒºï¼Œä¸ºè¿›å‡ºå†…åŸè¦é“ã€‚'
    },
    'ç¼æ—è‹‘': {
      ancientName: 'ç¼æ—è‹‘',
      dynasty: 'åŒ—å®‹ (çš‡å®¶å›­æ—)',
      intro: 'åŒ—å®‹è‘—åçš‡å®¶å›­æ—ï¼Œä½äºé¡ºå¤©é—¨å¤–é‡‘æ˜æ± å—ï¼Œä¸ºæ–°ç§‘è¿›å£«ä¸¾è¡Œâ€œç¼æ—å®´â€çš„åœºæ‰€ï¼Œè±¡å¾æ–‡æ²»æ˜Œç››ã€‚'
    },
    'å¤ªå¹³å…´å›½å¯º': {
      ancientName: 'å¤ªå¹³å…´å›½å¯º',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹é‡è¦çš‡å®¶åŠŸå¾·å¯ºé™¢ï¼Œç”±å®‹å¤ªå®—ä»¥å…¶å¹´å·â€œå¤ªå¹³å…´å›½â€æ••å»ºï¼Œä¸ºå®‹ä»£ä½›æ•™æ´»åŠ¨ä¸­å¿ƒä¹‹ä¸€ã€‚'
    },
    'é†´æ³‰è§‚': {
      ancientName: 'é†´æ³‰è§‚',
      dynasty: 'åŒ—å®‹ (çš‡å®¶é“è§‚)',
      intro: 'åŒ—å®‹ä¸œäº¬è‘—åçš‡å®¶é“è§‚ï¼Œä¸»è¦ä¾›å¥‰ä¸œå²³æ³°å±±ç¥ï¼Œæ˜¯æœå»·ä¸¾è¡Œå›½å®¶ç¥­ç¥€ä¸é“æ•™é†®ä»ªçš„é‡è¦åœºæ‰€ã€‚'
    },
    'ç›¸å›½å¯ºæ¡¥': {
      ancientName: 'ç›¸å›½å¯ºæ¡¥',
      dynasty: 'åŒ—å®‹',
      intro: 'æ±´æ²³ä¸Šé‡è¦æ¡¥æ¢ï¼Œè¿æ¥å¤§ç›¸å›½å¯ºä¸å‘¨è¾¹ç¹åå•†ä¸šåŒºï¼Œä¸ºä¸œäº¬åŸäº¤é€šè¦é“ï¼Œè§è¯äº†åŸå¸‚ç¹è£ã€‚'
    },
    'æ¡‘å®¶ç“¦å­': {
      ancientName: 'æ¡‘å®¶ç“¦èˆ',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹ä¸œäº¬åŸè§„æ¨¡æœ€å¤§ã€æœ€è´Ÿç››åçš„ç»¼åˆæ€§å¨±ä¹ä¸­å¿ƒï¼ˆç“¦èˆï¼‰ï¼Œæ˜¯ä¸­ç“¦ã€é‡Œç“¦ç­‰å‹¾æ èšé›†åœ°ï¼Œä¸ºå¸‚æ°‘æ–‡åŒ–ä»£è¡¨ã€‚'
    },
    'é©¬è¡Œè¡—': {
      ancientName: 'é©¬è¡Œè¡—',
      dynasty: 'åŒ—å®‹',
      intro: 'åŒ—å®‹ä¸œäº¬åŸå—åŒ—å‘åŒ»è¯äº§ä¸šæ ¸å¿ƒåŒºä¸ç¹åå•†ä¸šè¡—ï¼ŒåŒ—èµ·æ—§å°ä¸˜é—¨ï¼Œå—æ¥æ½˜æ¥¼è¡—åŒºï¼ŒåŒ»é¦†è¯é“ºæ—ç«‹ã€‚'
    },
    'å¼€å°åŸå¢™': {
      ancientName: 'å¼€å°åŸ',
      dynasty: 'å”å§‹å»ºï¼Œå†ä»£é‡ä¿®',
      intro: 'ä¸­å›½ç°å­˜æœ€å®Œæ•´çš„å¤ä»£åŸå¢™ä¹‹ä¸€ï¼Œå§‹å»ºäºå”ï¼Œç°å­˜ä¸»ä½“ä¸ºæ¸…ä»£é‡å»ºï¼Œå‘¨é•¿14.4å…¬é‡Œï¼Œæ˜¯ä¸–ç•Œç½•è§çš„â€œåŸæ‘åŸâ€å¥‡è§‚å®è¯ã€‚'
    },

    // é»˜è®¤æ•°æ®
    'default': {
      ancientName: 'èµ„æ–™æ•´ç†ä¸­',
      dynasty: 'å¾…è€ƒè¯',
      intro: 'è¯¥é—å€çš„è¯¦ç»†å†å²èµ„æ–™æ­£åœ¨ç³»ç»Ÿæ•´ç†ä¸è€ƒè¯ä¸­ï¼Œæ›´å¤šä¿¡æ¯æ•¬è¯·æœŸå¾…åç»­æ›´æ–°ã€‚'
    }
  };
  return detailsMap[name] || detailsMap.default;
},

  // æ ¹æ®ç±»å‹è·å–å¯¹åº”çš„å›¾æ ‡
getTypeIcon(type) {
  const iconMap = {
    // åŸé—¨/å®«é˜™ç±» - åŸé—¨å›¾æ ‡
    'åŸé—¨é—å€': '/images/marker-gate.png',
    
    // å®—æ•™å»ºç­‘ç±» - å®—æ•™å›¾æ ‡
    'å®—æ•™å»ºç­‘': '/images/marker-temple.png',
    
    // é—å€/è€ƒå¤ç‚¹ç±» - é—å€å›¾æ ‡
    'é—å€': '/images/marker-site.png',
    
    // æ–‡åšåœºé¦†ç±» - æ–‡åšå›¾æ ‡
    'æ–‡åšåœºé¦†': '/images/marker-museum.png',
    
    // å®«æ®¿é—å€ - ä½¿ç”¨åŸé—¨å›¾æ ‡
    'å®«æ®¿é—å€': '/images/marker-gate.png',
    
    // å›­æ—é—å€ - ä½¿ç”¨é—å€å›¾æ ‡
    'å›­æ—é—å€': '/images/marker-site.png',
    
    // è¡™ç½²é—å€ - ä½¿ç”¨é—å€å›¾æ ‡
    'è¡™ç½²é—å€': '/images/marker-site.png',
    
    // æ¡¥æ¢é—å€ - ä½¿ç”¨é—å€å›¾æ ‡
    'æ¡¥æ¢é—å€': '/images/marker-site.png',
    
    // é˜²å¾¡é—å€ - ä½¿ç”¨åŸé—¨å›¾æ ‡
    'é˜²å¾¡é—å€': '/images/marker-gate.png',
    
    // æ°´ç³»é—å€ - ä½¿ç”¨é—å€å›¾æ ‡
    'æ°´ç³»é—å€': '/images/marker-site.png',
    
    // å•†ä¸šé—å€ - ä½¿ç”¨é—å€å›¾æ ‡
    'å•†ä¸šé—å€': '/images/marker-site.png',
    
    // å•†ä¸šè¡—åŒº - ä½¿ç”¨é—å€å›¾æ ‡
    'å•†ä¸šè¡—åŒº': '/images/marker-site.png',
    
    // ç°ä»£æ™¯åŒº - ä½¿ç”¨åŸé—¨å›¾æ ‡
    'ç°ä»£æ™¯åŒº': '/images/marker-gate.png',
    
    // é»˜è®¤å›¾æ ‡
    'default': '/images/marker-default.png'
  };
  
  // å°è¯•åŒ¹é…ç±»å‹
  for (const key in iconMap) {
    if (type && type.includes(key)) {
      return iconMap[key];
    }
  }
  
  // ç‰¹æ®Šå¤„ç†é€»è¾‘ï¼ˆä¸getMarkerStyleä¿æŒä¸€è‡´ï¼‰
  if (type && type.includes('é—å€') && !type.includes('åŸé—¨')) {
    return iconMap['é—å€']; // é—å€å›¾æ ‡
  }
  
  if (type && type.includes('å»ºç­‘')) {
    return iconMap['å®—æ•™å»ºç­‘']; // å®—æ•™å›¾æ ‡
  }
  
  if (type && (type.includes('åœºé¦†') || type.includes('åšç‰©é¦†'))) {
    return iconMap['æ–‡åšåœºé¦†']; // æ–‡åšå›¾æ ‡
  }
  
  if (type && type.includes('åŸé—¨')) {
    return iconMap['åŸé—¨é—å€']; // åŸé—¨å›¾æ ‡
  }
  
  return iconMap.default;
},

// æ ¹æ®ç±»å‹è·å–é¢œè‰²
getTypeColor(type) {
  const colorMap = {
    // åŸé—¨/å®«é˜™ç±» - éœçº¢è‰²
    'åŸé—¨é—å€': '#d2704d', // éœçº¢è‰²
    
    // å®—æ•™å»ºç­‘ç±» - å¤©é’è‰²
    'å®—æ•™å»ºç­‘': '#5d95a9', // å¤©é’è‰²
    
    // é—å€/è€ƒå¤ç‚¹ç±» - æ±´ç»¿è‰²
    'é—å€': '#709a89', // æ±´ç»¿è‰²
    
    // æ–‡åšåœºé¦†ç±» - æ·±è¤è‰²
    'æ–‡åšåœºé¦†': '#3b0d0d', // æ·±è¤è‰²
    
    // å®«æ®¿é—å€ - ä½¿ç”¨ä¸åŸé—¨ç›¸è¿‘çš„é¢œè‰²
    'å®«æ®¿é—å€': '#d2704d', // ä¹Ÿä½¿ç”¨éœçº¢è‰²
    
    // å›­æ—é—å€ - ä½¿ç”¨æ±´ç»¿è‰²
    'å›­æ—é—å€': '#709a89', // æ±´ç»¿è‰²
    
    // è¡™ç½²é—å€ - ä½¿ç”¨æ±´ç»¿è‰²
    'è¡™ç½²é—å€': '#709a89', // æ±´ç»¿è‰²
    
    // æ¡¥æ¢é—å€ - ä½¿ç”¨æ±´ç»¿è‰²
    'æ¡¥æ¢é—å€': '#709a89', // æ±´ç»¿è‰²
    
    // é˜²å¾¡é—å€ - ä½¿ç”¨éœçº¢è‰²
    'é˜²å¾¡é—å€': '#d2704d', // éœçº¢è‰²
    
    // æ°´ç³»é—å€ - ä½¿ç”¨æ±´ç»¿è‰²
    'æ°´ç³»é—å€': '#709a89', // æ±´ç»¿è‰²
    
    // å•†ä¸šé—å€ - ä½¿ç”¨æ±´ç»¿è‰²
    'å•†ä¸šé—å€': '#d2704d', // æ±´ç»¿è‰²
    
    // å•†ä¸šè¡—åŒº - ä½¿ç”¨æ±´ç»¿è‰²
    'å•†ä¸šè¡—åŒº': '#d2704d', // æ±´ç»¿è‰²
    
    // ç°ä»£æ™¯åŒº - ä½¿ç”¨éœçº¢è‰²
    'ç°ä»£æ™¯åŒº': '#d2704d', // éœçº¢è‰²
    
    // é»˜è®¤é¢œè‰²
    'default': '#d2704d'
  };
  
  // å°è¯•åŒ¹é…ç±»å‹
  for (const key in colorMap) {
    if (type && type.includes(key)) {
      return colorMap[key];
    }
  }
  
  // ç‰¹æ®Šå¤„ç†é€»è¾‘ï¼ˆä¸getMarkerStyleä¿æŒä¸€è‡´ï¼‰
  if (type && type.includes('é—å€') && !type.includes('åŸé—¨')) {
    return colorMap['é—å€']; // æ±´ç»¿è‰²
  }
  
  if (type && type.includes('å»ºç­‘')) {
    return colorMap['å®—æ•™å»ºç­‘']; // å¤©é’è‰²
  }
  
  if (type && (type.includes('åœºé¦†') || type.includes('åšç‰©é¦†'))) {
    return colorMap['æ–‡åšåœºé¦†']; // æ·±è¤è‰²
  }
  
  if (type && type.includes('åŸé—¨')) {
    return colorMap['åŸé—¨é—å€']; // éœçº¢è‰²
  }
  
  return colorMap.default;
},
// æ ¹æ®ç±»å‹è·å–å¼¹çª—å›¾æ ‡èƒŒæ™¯é¢œè‰²
// æ ¹æ®ç±»å‹è·å–å¼¹çª—å›¾æ ‡èƒŒæ™¯é¢œè‰² - ä¸åœ°å›¾æ ‡è®°é¢œè‰²ä¸€è‡´
// æ ¹æ®ç±»å‹è·å–å¼¹çª—å›¾æ ‡èƒŒæ™¯é¢œè‰² - ä¸åœ°å›¾æ ‡è®°é¢œè‰²ä¸€è‡´
getPopupBgColor(type) {
  return this.getTypeColor(type); // ç›´æ¥ä½¿ç”¨å·²æœ‰çš„é¢œè‰²å‡½æ•°
},
// æ ¹æ®ç±»å‹è·å–ç™½è‰²å›¾æ ‡è·¯å¾„
getPopupIcon(type) {
  const iconMap = {
    'åŸé—¨é—å€': '/images/icon-gate-white.png',
    'åŸé—¨/å®«é˜™ç±»': '/images/icon-gate-white.png',
    
    'å®—æ•™å»ºç­‘': '/images/icon-temple-white.png',
    'å®—æ•™å»ºç­‘ç±»': '/images/icon-temple-white.png',
    
    'é—å€': '/images/icon-shovel-white.png',
    'é—å€/è€ƒå¤ç‚¹ç±»': '/images/icon-shovel-white.png',
    
    'æ–‡åšåœºé¦†': '/images/icon-book-white.png',
    'æ–‡åšåœºé¦†ç±»': '/images/icon-book-white.png',
    
    'default': '/images/icon-marker-white.png'
  };
  
  return this.matchType(type, iconMap) || iconMap.default;
},

// é€šç”¨çš„ç±»å‹åŒ¹é…å‡½æ•°ï¼ˆé¿å…é‡å¤ä»£ç ï¼‰
matchType(type, map) {
  if (!type) return null;
  
  // 1. ç²¾ç¡®åŒ¹é…
  for (const key in map) {
    if (type.includes(key)) {
      return map[key];
    }
  }
  
  // 2. æ™ºèƒ½å½’ç±»
  if (type.includes('é—å€') && !type.includes('åŸé—¨')) {
    return map['é—å€'];
  }
  
  if (type.includes('å»ºç­‘')) {
    return map['å®—æ•™å»ºç­‘'];
  }
  
  if (type.includes('åœºé¦†') || type.includes('åšç‰©é¦†')) {
    return map['æ–‡åšåœºé¦†'];
  }
  
  if (type.includes('åŸé—¨')) {
    return map['åŸé—¨é—å€'];
  }
  
  return null;
},
  // å…³é—­å¼¹çª—
  closeBottomPopup() {
    this.setData({
      showBottomPopup: false,
      popupData: null
    });
  },

  // é˜»æ­¢äº‹ä»¶å†’æ³¡
  stopPropagation() {
    // ä»€ä¹ˆéƒ½ä¸åšï¼Œåªæ˜¯é˜»æ­¢å†’æ³¡
  },

  // æŸ¥çœ‹è¯¦æƒ… - è·³è½¬åˆ°æ–°é¡µé¢
  goToDetailPage(e) {
    // é˜»æ­¢äº‹ä»¶å†’æ³¡
    if (e && e.stopPropagation) {
      e.stopPropagation();
    }
    
    if (this.data.popupData) {
      const landmarkName = this.data.popupData.name;
      
      console.log('è·³è½¬åˆ°è¯¦æƒ…é¡µ:', landmarkName);
      
      // è·³è½¬åˆ°è¯¦æƒ…é¡µ
      wx.navigateTo({
        url: `/pages/landmark-info/index?name=${encodeURIComponent(landmarkName)}`
      });
    }
  },

  // ARè¯†è¿¹
  openAR(e) {
    // é˜»æ­¢äº‹ä»¶å†’æ³¡
    if (e && e.stopPropagation) {
      e.stopPropagation();
    }
    
    wx.showToast({
      title: 'ARè¯†è¿¹åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­',
      icon: 'none',
      duration: 2000
    });
  },

  // åœ°å›¾å¯¼èˆª
  openNavigation(e) {
    // é˜»æ­¢äº‹ä»¶å†’æ³¡
    if (e && e.stopPropagation) {
      e.stopPropagation();
    }
    
    if (this.data.popupData) {
      const coordinates = this.getLandmarkCoordinates(this.data.popupData.name);
      
      if (coordinates) {
        wx.openLocation({
          latitude: coordinates.latitude,
          longitude: coordinates.longitude,
          name: this.data.popupData.name,
          address: 'å¼€å°å†å²é—å€',
          scale: 18
        });
      }
    }
  },

  // æ ¹æ®åç§°è·å–åæ ‡
getLandmarkCoordinates(name) {
  const coordinateMap = {
    // åŸæœ‰åæ ‡ (ä¿æŒæ ¼å¼ä¸€è‡´)
    'é“å¡”': { latitude: 34.81297911, longitude: 114.3665947 },
    'ç¹å¡”': { latitude: 34.769842, longitude: 114.364807 },
    'é¾™äº­å…¬å›­': { latitude: 34.811187, longitude: 114.35113 },
    'å¤§ç›¸å›½å¯º': { latitude: 34.7919434, longitude: 114.35460544 },
    'æ¸…æ˜ä¸Šæ²³å›­': { latitude: 34.809044, longitude: 114.340685 },
    'å¤©æ³¢æ¨åºœ': { latitude: 34.810734, longitude: 114.347433 },
    'åŒ…å…¬ç¥ ': { latitude: 34.792935, longitude: 114.33911 },
    'ä¸­å›½ç¿°å›­': { latitude: 34.80992, longitude: 114.344712 },
    'å¤§å®‹æ­¦ä¾ åŸ': { latitude: 34.819966, longitude: 114.3518 },
    
    // ä»GeoJSONä¸­æå–çš„åæ ‡ (ID 1-29)
    'é¡ºå¤©é—¨': { latitude: 34.79514005, longitude: 114.30506137 },
    'ä¸‡èƒœé—¨é—å€': { latitude: 34.805, longitude: 114.298 },
    'æ™¯é¾™é—¨é—å€': { latitude: 34.8165, longitude: 114.3582 },
    'å·æ¡¥é—å€': { latitude: 34.790644, longitude: 114.350844 },
    'æ±´æ²³é—å€': { latitude: 34.79137629, longitude: 114.34581348 },
    'æ±´æ²³æ•…é“ï¼ˆå±€éƒ¨æ®µï¼‰': { latitude: 34.79137629, longitude: 114.34581348 },
    'å¤–åŸæŠ¤åŸå£•è¥¿å¢™å—æ®µ': { latitude: 34.7868, longitude: 114.2915 },
    'å¤–åŸå—å¢™æŠ¤åŸå£•ï¼ˆå—è–°é—¨æ®µï¼‰': { latitude: 34.7892, longitude: 114.3058 },
    'å†…åŸæŠ¤åŸå£•åŒ—å¢™æ®µ': { latitude: 34.7981, longitude: 114.3076 },
    'å·æ¡¥é—å€æŠ¤åŸå…³è”åŒº': { latitude: 34.7925, longitude: 114.3082 },
    'æ˜ä»£å‘¨ç‹åºœå…¸ä»ªæ‰€æ ¸å¿ƒåŒº': { latitude: 34.7938, longitude: 114.3526 },
    'é¡ºå¤©é—¨é—å€åšç‰©é¦†': { latitude: 34.79514005, longitude: 114.30506137 },
    'å¤§åº†æ®¿': { latitude: 34.80504713, longitude: 114.35216703 },
    'å¼€å°åºœ': { latitude: 34.78970693, longitude: 114.34648023 },
    'æœ±é›€é—¨': { latitude: 34.78570687, longitude: 114.34999825 },
    'å—è–°é—¨': { latitude: 34.7824267, longitude: 114.34975415 },
    'æ–°é—¨': { latitude: 34.78177436, longitude: 114.35874464 },
    'å¤§æ¢é—¨': { latitude: 34.8020847, longitude: 114.32911439 },
    'æ›¹é—¨': { latitude: 34.8005551, longitude: 114.36564974 },
    'å®‹é—¨': { latitude: 34.78762725, longitude: 114.36155453 },
    'é‡‘æ˜æ± ': { latitude: 34.79970635, longitude: 114.30093852 },
    'å¼€å®å¯º': { latitude: 34.81220727, longitude: 114.37253228 },
    'å¤©æ´¥æ¡¥': { latitude: 34.79054879, longitude: 114.3517204 },
    'æ¨Šæ¥¼': { latitude: 34.80216961, longitude: 114.35125766 },
    'å¼€å°åºœï¼ˆç°ä»£æ™¯åŒºï¼‰': { latitude: 34.789726, longitude: 114.3465 },
    
    // ä»GeoJSONä¸­æå–çš„åæ ‡ (ID 30-43)
    'å¼€å°åšç‰©é¦†': { latitude: 34.803533, longitude: 114.253818 },
    'å¼€å°ç¾æœ¯åšç‰©é¦†': { latitude: 34.803475, longitude: 114.255025 },
    'å·æ¡¥é—å€åšç‰©é¦†': { latitude: 34.790644, longitude: 114.350844 },
    'ä¹¦åº—è¡—': { latitude: 34.799431, longitude: 114.356206 },
    'é©¬é“è¡—': { latitude: 34.793751, longitude: 114.355622 },
    'é¼“æ¥¼è¡—': { latitude: 34.793724, longitude: 114.357801 },
    'å¤§å®‹å¾¡æ²³ï¼ˆæ¸¸èˆ¹ï¼‰': { latitude: 34.807615, longitude: 114.344842 },
    'é¼“æ¥¼å¤œå¸‚': { latitude: 34.793914, longitude: 114.355996 },
    'å°å®‹åŸ': { latitude: 34.803281, longitude: 114.310757 },
    
    // ä»GeoJSONä¸­æå–çš„åæ ‡ (ID 44-53)
    'å®£å¾·é—¨': { latitude: 34.803083, longitude: 114.351514 },
    'å¾¡å²å°': { latitude: 34.793285, longitude: 114.338049 },
    'ä¿åº·é—¨': { latitude: 34.785792, longitude: 114.331467 },
    'ç¼æ—è‹‘': { latitude: 34.795788, longitude: 114.303684 },
    'å¤ªå¹³å…´å›½å¯º': { latitude: 34.800740, longitude: 114.332456 },
    'é†´æ³‰è§‚': { latitude: 34.806838, longitude: 114.322948 },
    'ç›¸å›½å¯ºæ¡¥': { latitude: 34.788120, longitude: 114.353320 },
    'æ¡‘å®¶ç“¦å­': { latitude: 34.793358, longitude: 114.354887 },
    'é©¬è¡Œè¡—': { latitude: 34.814558, longitude: 114.364113 },
    'å¼€å°åŸå¢™': { latitude: 34.798, longitude: 114.348 }
  };
  
  return coordinateMap[name] || null;
},
  toggleAncientLayer() {
    console.log('åˆ‡æ¢å¤ä»Šå›¾å±‚ï¼ˆåŠŸèƒ½é¢„ç•™ï¼‰');
    wx.showToast({
      title: 'åŠŸèƒ½å¼€å‘ä¸­',
      icon: 'none'
    });
  }
});